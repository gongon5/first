<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="style.css" type="text/css">
</head>
<body>
    <div class="quiz_area">
    <div class="quiz_set">
        ç¬¬<span class="quiz_no">0</span>å•
        <div class="quiz_question"></div>
        <div class="quiz_ans_area">
            <ul></ul>
        </div>
        <div class="quiz_area_bg"></div>
        <div class="quiz_area_icon"></div>
    </div>
    <div class="quiz_result"></div>
</div>

<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script>
$(function(){
    var quizArea = $('.quiz_area'); //ã‚¯ã‚¤ã‚ºã‚’ç®¡ç†ã™ã‚‹DOMã‚’æŒ‡å®š
    var quiz_html = quizArea.html(); //ã‚‚ã†ä¸€åº¦ã€€ã‚’æŠ¼ã—ãŸæ™‚ã«å…ƒã«æˆ»ã™ãŸã‚åˆæœŸHTMLã‚’å¤‰æ•°ã§ä¿ç®¡
    var quiz_cnt = 0; //ç¾åœ¨ã®å•é¡Œæ•°ã‚’ç®¡ç†
    var quiz_fin_cnt = 5; //ä½•å•ã§çµ‚äº†ã‹è¨­å®šï¼ˆã‚¯ã‚¤ã‚ºæ•°ä»¥ä¸‹ã§ã‚ã‚‹ã“ã¨ï¼‰
    var quiz_success_cnt = 0; //å•é¡Œã®æ­£è§£æ•°
    
    //ã‚¯ã‚¤ã‚ºã®é…åˆ—ã‚’è¨­å®š
    //answerã®é¸æŠè‚¢ã®æ•°ã¯ã„ãã¤ã§ã‚‚OKã€€ãŸã ã—å…ˆé ­ã‚’æ­£è§£ã¨ã™ã‚‹ã“ã¨(å‡ºé¡Œæ™‚ã«é¸æŠè‚¢ã¯ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚Œã‚‹)
    var aryQuiz = [];
    aryQuiz.push(
        {
            question : 'æ¬¡ã®ã†ã¡ã€ç”°ä¸­è±ªã®èª•ç”Ÿæ—¥ã¯ã©ã‚Œï¼Ÿ',
            answer : ['5/15', '5/12', '5/7', '5/26']
        }
        ,{
            question : 'ç”°ä¸­å­å²ã®æ€§ç™–ã¯ã©ã‚Œï¼Ÿ',
            answer : ['ã†ãªã˜', 'ã‚¹ãƒæ¯›', 'ã½ã£ã¡ã‚ƒã‚Š', 'å¾®ç†Ÿå¥³']
        }
        ,{
            question : 'ç”°ä¸­è±ªã®å½¼å¥³ã®åå‰ã¯ï¼Ÿï¼ˆï¼‰',
            answer : ['ã‘ã„ãª', 'ã¾ã‚Šã‚“', 'ã¡ã•ã¨', 'ã¿ã©ã‚Š']
        }
        ,{
            question : 'ç”°ä¸­è±ªã®å¥½ããªã‚»ã‚¯ã‚·ãƒ¼å¥³å„ªã¯ï¼Ÿ',
            answer : ['ç¾è°·æœ±ç†', 'ä¸ŠåŸäºœè¡£', 'è·¡è¦‹ã—ã‚…ã‚Š', 'æ·±ç”°ãˆã„ã¿']
        }
        ,{
            question : 'ã“ã®ã‚¢ãƒ—ãƒªã‚’ä¸€æ™©ã§ä½œã‚Šä¸Šã’ã¾ã—ãŸã€‚ç”°ä¸­è±ªã‚’ä¼‘å­¦ã•ã›ã¾ã™ã‹ï¼Ÿ',
            answer : ['Yes', 'No', 'So-So', 'ğŸ˜„']
        }
    );
    
    quizReset();
    
    //å›ç­”ã‚’é¸æŠã—ãŸå¾Œã®å‡¦ç†
    quizArea.on('click', '.quiz_ans_area ul li', function(){
        //ç”»é¢ã‚’æš—ãã™ã‚‹ãƒœãƒƒã‚¯ã‚¹ã‚’è¡¨ç¤ºï¼ˆä¸Šã‹ã‚‰é‡ã­ã¦ã€çµæœè¡¨ç¤ºä¸­ã¯é¸æŠè‚¢ã®ã‚¯ãƒªãƒƒã‚¯ã‚„ã‚¿ãƒƒãƒ—ã‚’å°ã˜ã‚‹
        quizArea.find('.quiz_area_bg').show();
        //é¸æŠã—ãŸå›ç­”ã«è‰²ã‚’ä»˜ã‘ã‚‹
        $(this).addClass('selected');
        if($(this).data('true')){
            //æ­£è§£ã®å‡¦ç† ã€‡ã‚’è¡¨ç¤º
            quizArea.find('.quiz_area_icon').addClass('true');
            //æ­£è§£æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
            quiz_success_cnt++;
        }else{
            //ä¸æ­£è§£ã®å‡¦ç†
            quizArea.find('.quiz_area_icon').addClass('false');
        }
        setTimeout(function(){
            //è¡¨ç¤ºã‚’å…ƒã«æˆ»ã™
            quizArea.find('.quiz_ans_area ul li').removeClass('selected');
            quizArea.find('.quiz_area_icon').removeClass('true false');
            quizArea.find('.quiz_area_bg').hide();
            //å•é¡Œã®ã‚«ã‚¦ãƒ³ãƒˆã‚’é€²ã‚ã‚‹
            quiz_cnt++;
            if(quiz_fin_cnt > quiz_cnt){
                //æ¬¡ã®å•é¡Œã‚’è¨­å®šã™ã‚‹
                quizShow();
            }else{
                //çµæœè¡¨ç¤ºç”»é¢ã‚’è¡¨ç¤º
                quizResult();
            }
        }, 1500);
    });
    
    //ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹ã‚’æŠ¼ã—ãŸæ™‚ã®å‡¦ç†
    quizArea.on('click', '.quiz_restart', function(){
        quizReset();
    });
    
    //ãƒªã‚»ãƒƒãƒˆã‚’è¡Œã†é–¢æ•°
    function quizReset(){
        quizArea.html(quiz_html); //è¡¨ç¤ºã‚’å…ƒã«æˆ»ã™
        quiz_cnt = 0;
        quiz_success_cnt = 0;
        //aryQuiz = arrShuffle(aryQuiz); //æ¯å›å‡ºé¡Œã®é †ç•ªã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ãŸã„å ´åˆã¯ã“ã“ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ¶ˆã—ã¦ã­
        quizShow();
    }
    
    //å•é¡Œã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
    function quizShow(){
        //ä½•å•ç›®ã‹ã‚’è¡¨ç¤º
        quizArea.find('.quiz_no').text((quiz_cnt + 1));
        //å•é¡Œæ–‡ã‚’è¡¨ç¤º
        quizArea.find('.quiz_question').text(aryQuiz[quiz_cnt]['question']);
        //æ­£è§£ã®å›ç­”ã‚’å–å¾—ã™ã‚‹
        var success = aryQuiz[quiz_cnt]['answer'][0];
        //ç¾åœ¨ã®é¸æŠè‚¢è¡¨ç¤ºã‚’å‰Šé™¤ã™ã‚‹
        quizArea.find('.quiz_ans_area ul').empty();
        //å•é¡Œæ–‡ã®é¸æŠè‚¢ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã›ã‚‹(è‡ªä½œé–¢æ•°) .concat()ã¯å‚ç…§æ¸¡ã—å¯¾ç­–
        var aryHoge = arrShuffle(aryQuiz[quiz_cnt]['answer'].concat());
        //å•é¡Œæ–‡ã®é…åˆ—ã‚’ç¹°ã‚Šè¿”ã—è¡¨ç¤ºã™ã‚‹
        $.each(aryHoge, function(key, value){
            var fuga = '<li>' + value + '</li>';
            //æ­£è§£ã®å ´åˆã¯dataå±æ€§ã‚’ä»˜ä¸ã™ã‚‹
            if(success === value){
                fuga = '<li data-true="1">' + value + '</li>';
            }
            quizArea.find('.quiz_ans_area ul').append(fuga);
        });
    }
    
    //çµæœã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
    function quizResult(){
        quizArea.find('.quiz_set').hide();
        var text = quiz_fin_cnt + 'å•ä¸­' + quiz_success_cnt + 'å•æ­£è§£ï¼';
        if(quiz_fin_cnt === quiz_success_cnt){
            text += '<br>å…¨å•æ­£è§£ãŠã‚ã§ã¨ã†ï¼';
        }
        text += '<br><input type="button" value="ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹" class="quiz_restart p-10">';
        quizArea.find('.quiz_result').html(text);
        quizArea.find('.quiz_result').show();
    }
    
    //é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã™ã‚‹é–¢æ•°
    function arrShuffle(arr){
        for(i = arr.length - 1; i > 0; i--){
            var j = Math.floor(Math.random() * (i + 1));
            var tmp = arr[i];
            arr[i] = arr[j];
            arr[j] = tmp;
        }
        return arr;
    }
});
</script>
</body>
</html>
